<!DOCTYPE html>
<html>
<head>
<title>Terminal</title>
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
<style>
body {
  background-color: #000;
  color: #eee;
  font-family: 'Roboto Mono', monospace;
  margin: 0;
  padding: 0;
}
article {
  background-color: #000;
  float: right;
  height: 350px;
  margin-right: 2.5%;
  vertical-align: bottom;
  width: 95%;
}
article textarea {
  background-color: #000;
  color: #eee;
  height:100%;
  width:100%;
}
pre {
  margin: 0;
}
section {
  background-color: #000;
  float: right;
  margin: 1% 2.5%;
  width: 95%;
}
section > * {
  display: inline-block;
  width: 220px;
}
.details {
  background-color: #000;
  float: right;
  margin-top: 2.5%;
  margin-right: 2.5%;
  width: 95%;
}
progress[value]::-webkit-progress-bar {
  background-color: #eee;
  border-radius: 2px;
  box-shadow: 0 2px 2.5% rgba(0, 0, 0, 0.25) inset;
}
.ok{
  color: #33FF00;
}
.warn {
  color: #FFCC00;
}
.error{
  color: #DC322F;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
<header>
</header>
<content>
<section>
  <time>0000000000</time>
  <div><span id="connectionstatus" class="warn"> </span> <span id="sessionLen"> </span></div>
</section>
<article>
  <textarea>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
[user@terminal ~]# </textarea>
</article>
<div id="results"></div>
</content>

<footer>
</footer>
<script>
var gotoend = function () {
  var val = $('textarea').val();
  $('textarea').val("");
  $('textarea').val(val);
  $('textarea').scrollTop($('textarea')[0].scrollHeight);
}
$('textarea').click(function(e) {
  gotoend();
});
$('textarea').keyup(function(e) {
    if (e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 39 || e.keyCode == 40) {
      gotoend();
    }
});
$('textarea').keydown(function(e) {
    if (e.keyCode == 13) {
        e.preventDefault();
        var commands = $('textarea').val().split('[user@terminal ~]# ');
        
        var processId = Math.ceil(Math.random() * 100000000);
        
        $('<div id="'+processId+'" class="details"></div>').html('<pre>Processing...</pre>').prependTo( "#results");
        
        $.ajax({
          type: "GET",
          data: {'pid':processId},
          url: 'https://api.terminalwindow.io/LATEST/'+commands[commands.length-1],
          context: document.body,
          dataType: 'json'
        }).done(function(data) {
          $('#'+data.pid).html('<pre>'+data.data+'</pre>');
        });
        
        $('textarea').val($('textarea').val()+"\n"+'[user@terminal ~]# ');
        $('textarea').scrollTop($('textarea')[0].scrollHeight);
    }
});
</script>
</body>
</html>